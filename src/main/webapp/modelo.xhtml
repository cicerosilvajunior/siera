<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:b="http://butterfaces.org/components"
	template="/WEB-INF/templates/default.xhtml"
	xmlns:rich="http://richfaces.org/rich">
	<ui:define name="content">
	<h:head>
		<link
			href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"
			rel="stylesheet" />
			
			<link
				href="resources/css/edmtool.css"
				rel="stylesheet" />	
				
		<style type="text/css">

.header-fixed-placeholder{
	height: 280px;
	display: none;
}

table {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
  	border-collapse: collapse;
	border-spacing: 0;
}

table#confusionMatrix, table, th, td {
	border: 1px solid #CCC;
    border-collapse: collapse;
    padding: 1px;
}

th {
    text-align: center;    
}
td {
    text-align: left;    
}

.rotate {
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  width: 1.5em;
}
.rotate div {
     -moz-transform: rotate(-90.0deg);  /* FF3.5+ */
       -o-transform: rotate(-90.0deg);  /* Opera 10.5 */
  -webkit-transform: rotate(-90.0deg);  /* Saf3.1+, Chrome */
             filter:  progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083);  /* IE6,IE7 */
         -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)"; /* IE8 */
         margin-left: -10em;
         margin-right: -10em;
}
</style>
	</h:head>
	
	  <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
  <div class="navbar-header">
    <a class="navbar-brand" href="#"></a>
  </div>
  <div class="collapse navbar-collapse">
    <ul class="nav navbar-nav">
      <li class="active"><a href="index.jsf">Início</a></li>
      <li><a href="classificacao.jsf">Classificação</a></li>
      <li><a href="analisedesempenho.jsf">Avaliação de Conhecimento</a></li>
    </ul>
  </div><!-- /.navbar-collapse -->
  </div>
</nav>
		<h:form>
		<br/>
			<div class="container">
				<div class="page-header">
					<h1>
						<small>Modelo de Classificação de Alunos</small>
					</h1>
				</div>
				<div class="panel panel-primary">
					<div class="panel-heading">Treinamento do Modelo</div>
					<div class="panel-body">

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Processo
								de classificação:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.id}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Data:</label>
							<div class="controls col-sm-3">
								<h:outputText class="control-label"
									value="#{modeloClassificacao.modelo.date}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Algoritmo:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.modelo.algorithm}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Dados
								utilizados:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.relation}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Total
								de alunos:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.instancesTotal}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Total
								de atributos:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.attributesTotal}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Atributos:</label>
							<div class="controls col-sm-9">
								<span class="control-label">#{modeloClassificacao.attributesList}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Método de validação cruzada:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.testMode}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Classificações corretas:</label>
							<div class="controls col-sm-3">
								<h:outputText
									value="#{modeloClassificacao.modelo.correctlyClassified}"
									styleClass="control-label">
									<f:convertNumber integerOnly="true" />
								</h:outputText>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Classificações incorretas:</label>
							<div class="controls col-sm-3">
								<h:outputText
									value="#{modeloClassificacao.modelo.incorrectlyClassified}"
									styleClass="control-label">
									<f:convertNumber integerOnly="true" />
								</h:outputText>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Precisão:</label>
							<div class="controls col-sm-1">
								<h:outputText value="#{modeloClassificacao.accuracy}"
									styleClass="control-label">
									<f:convertNumber type="number" maxFractionDigits="2" />
								</h:outputText>
								%
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Coeficiente Kappa:</label>
							<div class="controls col-sm-1">
								<h:outputText class="control-label"
									value="#{modeloClassificacao.modelo.kappaStatistic}">
									<f:convertNumber type="number" maxFractionDigits="4" />
								</h:outputText>
							</div>
						</div>

						<div class="panel panel-default" style="display: inline-block;">
							<!-- Default panel contents -->
							<div class="panel-heading" style="background-color: #cccccc"><b>Matriz de confusão</b></div>

							<table id="confusionMatrix"
								style="border: 1px solid #ccc; border-collapse: collapse; padding: 1px;">
								<tbody>
									<tr>
										<td colspan="2" rowspan="2"
											style="border: 1px solid #ccc; text-align: center; background-color: #f9f9f9">Instâncias</td>
										<td colspan="2"
											style="border: 1px solid #ccc; text-align: center; background-color: #f9f9f9">Verdadeiro</td>
									</tr>
									<tr style="border: 1px solid #ccc;">
										<td style="border: 1px solid #ccc; text-align: center;">Positivo</td>
										<td style="border: 1px solid #ccc; text-align: center;">Negativo</td>
									</tr>
									<tr>
										<td rowspan="4" class='rotate'
											style="border: 1px solid #ccc; text-align: center; white-space: nowrap; vertical-align: middle; width: 1.5em; background-color: #f9f9f9">
											<div
												style="-moz-transform: rotate(-90.0deg); -o-transform: rotate(-90.0deg); -webkit-transform: rotate(-90.0deg); margin-left: -10em; margin-right: -10em;">Predito</div>
										</td>
										<td style="text-align: center;">Positivo</td>
										<td style="text-align: center;"><button type="button"
												class="btn btn-success">
												Sim <span class="badge"> <h:outputText
														value="#{modeloClassificacao.modelo.totalTruePositive}" /></span>
											</button></td>
										<td style="text-align: center;"><button type="button"
												class="btn btn-danger">
												Não <span class="badge"><h:outputText
														value="#{modeloClassificacao.modelo.totalFalsePositive}" /></span>
											</button></td>
									</tr>
									<tr style="border: 1px solid #ccc;">
										<td style="text-align: center;">Negativo</td>
										<td style="text-align: center;"><button type="button"
												class="btn btn-danger">
												Não <span class="badge"><h:outputText
														value="#{modeloClassificacao.modelo.totalFalseNegative}" /></span>
											</button></td>
										<td style="text-align: center;"><button type="button"
												class="btn btn-success">
												Sim <span class="badge"><h:outputText
														value="#{modeloClassificacao.modelo.totalTrueNegative}" /></span>
											</button></td>
									</tr>
								</tbody>
							</table>

						</div>
					</div>
				</div>
			</div>
		</h:form>
		
		<div class="container">
				<div class="panel panel-primary">
					<div class="panel-heading">Resultados do Processo de Classificação</div>
					<div class="panel-body">
					
											<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Algoritmo:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.modelo.algorithm}</span>
							</div>
						</div>
						
						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Dados
								utilizados:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.testDataSet}</span>
							</div>
						</div>

						<div class="form-group row">
							<label class="control-label col-sm-3 col-form-label">Total
								de alunos:</label>
							<div class="controls col-sm-3">
								<span class="control-label">#{modeloClassificacao.modelo.instanciaList.size()}</span>
							</div>
						</div>
					
					
							<div class="panel panel-default">
							<!-- Default panel contents -->
							<div class="panel-heading">Alunos classificados</div>
					
							<b:table id="instanciasTable" var="rowItem"
								value="#{modeloClassificacao.modelo.instanciaListOrdered}"
								tableBordered="false" tableCondensed="true" tableStriped="true"
								ajaxDisableRenderRegionsOnRequest="false" rendered="true"
								styleClass="table" rowClass="table">

								<b:column id="column1" label="Identificação">
                #{rowItem.userId}
            </b:column>
								<b:column id="column7" label="Probabilidade de evasão">
									<button type="button" class="btn btn-warning">
										<span class="badge"> <h:outputText
												class="control-label" value="#{rowItem.probabilityClassA}">
												<f:convertNumber type="percent" minFractionDigits="12" />
											</h:outputText></span>
									</button>
								</b:column>

								<b:column id="column8" label="Probabilidade de conclusão">
									<button type="button" class="btn btn-info">
										<span class="badge"> <h:outputText
												class="control-label" value="#{rowItem.probabilityClassB}">
												<f:convertNumber type="percent" minFractionDigits="12" />
											</h:outputText></span>
									</button>
								</b:column>
								<b:column id="column3" label="Provável risco de evasão">

									<button type="button"
										class="#{rowItem.dropoutPrediction == 'SIM' ? 'btn btn-warning' : 'btn btn-info'}">
										<span class="badge"><h:outputText 
												value="#{rowItem.dropoutPrediction}" />
											</span>
									</button>

								</b:column>
								<b:column id="columnRealClass" label="Classe verdadeira">

									<button type="button"
										class="#{rowItem.dropoutTruth == 'SIM' ? 'btn btn-warning' : 'btn btn-info'}">
										<span class="badge"><h:outputText 
												value="#{rowItem.dropoutTruth}" />
											</span>
									</button>

								</b:column>
							</b:table>
							</div>
							
							</div>
						</div>							
						<div align="right">
							<h:outputLink styleClass="btn btn-info" value="classificacao.jsf">
								<span class="glyphicon glyphicon-arrow-left"></span> Voltar</h:outputLink>
						</div>

						</div>
	</ui:define>
</ui:composition>
